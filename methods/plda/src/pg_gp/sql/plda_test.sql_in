\timing
drop table if exists MADLIB_SCHEMA.lda_mymodel;
drop table if exists MADLIB_SCHEMA.lda_corpus;
drop table if exists MADLIB_SCHEMA.lda_testcorpus;
create table 
MADLIB_SCHEMA.lda_testcorpus ( id int4, contents int4[], topics MADLIB_SCHEMA.lda_topics_t ) 
distributed randomly;
insert into MADLIB_SCHEMA.lda_testcorpus (select * from MADLIB_SCHEMA.lda_mycorpus limit 10);
select MADLIB_SCHEMA.lda_run('MADLIB_SCHEMA.lda_mycorpus', 'MADLIB_SCHEMA.lda_mydict', 'MADLIB_SCHEMA.lda_mymodel', 'MADLIB_SCHEMA.lda_corpus', 100,10,0.5,0.5);
select MADLIB_SCHEMA.lda_label_test_documents('MADLIB_SCHEMA.lda_testcorpus', 'MADLIB_SCHEMA.lda_mymodel', 'MADLIB_SCHEMA.lda_corpus', 'MADLIB_SCHEMA.lda_mydict', 100,10,0.5,0.5);
select id, contents[1:5], (topics).topics[1:5], (topics).topic_d from MADLIB_SCHEMA.lda_testcorpus;