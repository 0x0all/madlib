create schema madlib;
\i sketches_drop.sql
DROP FUNCTION IF EXISTS madlib.big_or(bitmap1 bytea, bitmap2 bytea) CASCADE;
psql:sketches_drop.sql:1: NOTICE:  function madlib.big_or(bytea,bytea) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__fmsketch_trans(bitmaps bytea, input anyelement) CASCADE;
psql:sketches_drop.sql:2: NOTICE:  function madlib.__fmsketch_trans(bytea,anyelement) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__fmsketch_count_distinct(bitmaps bytea) CASCADE;
psql:sketches_drop.sql:3: NOTICE:  function madlib.__fmsketch_count_distinct(bytea) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__fmsketch_merge(bitmaps1 bytea, bitmaps2 bytea) CASCADE;
psql:sketches_drop.sql:4: NOTICE:  function madlib.__fmsketch_merge(bytea,bytea) does not exist, skipping
DROP AGGREGATE IF EXISTS madlib.fmsketch_dcount(anyelement);
psql:sketches_drop.sql:5: NOTICE:  aggregate madlib.fmsketch_dcount(anyelement) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__cmsketch_trans(bytea, int8) CASCADE;
psql:sketches_drop.sql:6: NOTICE:  function madlib.__cmsketch_trans(bytea,int8) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__cmsketch_final(bytea) CASCADE;
psql:sketches_drop.sql:7: NOTICE:  function madlib.__cmsketch_final(bytea) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__cmsketch_merge(bytea, bytea) CASCADE;
psql:sketches_drop.sql:8: NOTICE:  function madlib.__cmsketch_merge(bytea,bytea) does not exist, skipping
DROP AGGREGATE IF EXISTS madlib.cmsketch(int8);
psql:sketches_drop.sql:9: NOTICE:  aggregate madlib.cmsketch(int8) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.cmsketch_count(bytea, int8) CASCADE;
psql:sketches_drop.sql:10: NOTICE:  function madlib.cmsketch_count(bytea,int8) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.cmsketch_rangecount(bytea, int8, int8) CASCADE;
psql:sketches_drop.sql:11: NOTICE:  function madlib.cmsketch_rangecount(bytea,int8,int8) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.cmsketch_centile(bytea, int4) CASCADE;
psql:sketches_drop.sql:12: NOTICE:  function madlib.cmsketch_centile(bytea,int4) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.cmsketch_width_histogram(bytea, int8, int8, int4) CASCADE;
psql:sketches_drop.sql:13: NOTICE:  function madlib.cmsketch_width_histogram(bytea,int8,int8,int4) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.cmsketch_depth_histogram(bytea, int4) CASCADE;
psql:sketches_drop.sql:14: NOTICE:  function madlib.cmsketch_depth_histogram(bytea,int4) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__mfvsketch_trans(bytea, anyelement, int4) CASCADE;
psql:sketches_drop.sql:15: NOTICE:  function madlib.__mfvsketch_trans(bytea,anyelement,int4) does not exist, skipping
DROP FUNCTION IF EXISTS madlib.__mfvsketch_final(bytea) CASCADE;
psql:sketches_drop.sql:16: NOTICE:  function madlib.__mfvsketch_final(bytea) does not exist, skipping
DROP AGGREGATE IF EXISTS madlib.mfvsketch_top_histogram(anyelement, int4);
psql:sketches_drop.sql:17: NOTICE:  aggregate madlib.mfvsketch_top_histogram(anyelement,int4) does not exist, skipping
\i sketches.sql
-- FM Sketch Functions
DROP FUNCTION IF EXISTS madlib.big_or(bitmap1 bytea, bitmap2 bytea) CASCADE;
psql:sketches.sql:2: NOTICE:  function madlib.big_or(bytea,bytea) does not exist, skipping
CREATE FUNCTION madlib.big_or(bitmap1 bytea, bitmap2 bytea)
RETURNS bytea
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__fmsketch_trans(bitmaps bytea, input anyelement) CASCADE;
psql:sketches.sql:8: NOTICE:  function madlib.__fmsketch_trans(bytea,anyelement) does not exist, skipping
CREATE FUNCTION madlib.__fmsketch_trans(bitmaps bytea, input anyelement) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__fmsketch_count_distinct(bitmaps bytea) CASCADE;
psql:sketches.sql:14: NOTICE:  function madlib.__fmsketch_count_distinct(bytea) does not exist, skipping
CREATE FUNCTION madlib.__fmsketch_count_distinct(bitmaps bytea) 
RETURNS int8 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__fmsketch_merge(bitmaps1 bytea, bitmaps2 bytea) CASCADE;
psql:sketches.sql:20: NOTICE:  function madlib.__fmsketch_merge(bytea,bytea) does not exist, skipping
CREATE FUNCTION madlib.__fmsketch_merge(bitmaps1 bytea, bitmaps2 bytea) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.fmsketch_dcount(anyelement);
psql:sketches.sql:26: NOTICE:  aggregate madlib.fmsketch_dcount(anyelement) does not exist, skipping
CREATE AGGREGATE madlib.fmsketch_dcount(anyelement)
(
    sfunc = madlib.__fmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__fmsketch_count_distinct,
    
    initcond = '' 
);
-- CM Sketch Functions
-- We register __cmsketch_trans for varying numbers of arguments to support
-- a variety of agg function signatures.  The first 2 args are used to 
-- aggregate; the remaining args are carried along unchanged inside the 
-- return structure for the use of the UDA finalizer.
DROP FUNCTION IF EXISTS madlib.__cmsketch_trans(bytea, int8) CASCADE;
psql:sketches.sql:43: NOTICE:  function madlib.__cmsketch_trans(bytea,int8) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_trans(bitmaps bytea, input int8) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__cmsketch_trans(bytea, int8, int8) CASCADE;
psql:sketches.sql:49: NOTICE:  function madlib.__cmsketch_trans(bytea,int8,int8) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_trans(bitmaps bytea, input int8, arg1 int8) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__cmsketch_trans(bytea, int8, int8, int8) CASCADE;
psql:sketches.sql:55: NOTICE:  function madlib.__cmsketch_trans(bytea,int8,int8,int8) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_trans(bitmaps bytea, input int8, arg1 int8, arg2 int8) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__cmsketch_trans(bytea, int8, int8, int8, int8) CASCADE;
psql:sketches.sql:61: NOTICE:  function madlib.__cmsketch_trans(bytea,int8,int8,int8,int8) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_trans(bitmaps bytea, input int8, arg1 int8, arg2 int8, arg3 int8) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__cmsketch_final(bytea) CASCADE;
psql:sketches.sql:68: NOTICE:  function madlib.__cmsketch_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_final(counters bytea) 
RETURNS bytea 
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__cmsketch_merge(bytea, bytea) CASCADE;
psql:sketches.sql:74: NOTICE:  function madlib.__cmsketch_merge(bytea,bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_merge(bytea, bytea) 
RETURNS bytea
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.cmsketch(int8);
psql:sketches.sql:80: NOTICE:  aggregate madlib.cmsketch(int8) does not exist, skipping
CREATE AGGREGATE madlib.cmsketch(int8)
(
    sfunc = madlib.__cmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__cmsketch_final,
		
    initcond = ''
);
DROP FUNCTION IF EXISTS madlib.__cmsketch_count_final(bytea) CASCADE;
psql:sketches.sql:90: NOTICE:  function madlib.__cmsketch_count_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_count_final(bytea)
RETURNS int8
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.cmsketch_count(int8, int8);
psql:sketches.sql:96: NOTICE:  aggregate madlib.cmsketch_count(int8,int8) does not exist, skipping
CREATE AGGREGATE madlib.cmsketch_count(int8, int8)
(
    sfunc = madlib.__cmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__cmsketch_count_final,
		
    initcond = ''
);
DROP FUNCTION IF EXISTS madlib.__cmsketch_rangecount_final(bytea) CASCADE;
psql:sketches.sql:106: NOTICE:  function madlib.__cmsketch_rangecount_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_rangecount_final(bytea)
RETURNS int8
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.cmsketch_rangecount(int8, int8, int8);
psql:sketches.sql:112: NOTICE:  aggregate madlib.cmsketch_rangecount(int8,int8,int8) does not exist, skipping
CREATE AGGREGATE madlib.cmsketch_rangecount(int8, int8, int8)
(
    sfunc = madlib.__cmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__cmsketch_rangecount_final,
		
    initcond = ''
);
DROP FUNCTION IF EXISTS madlib.__cmsketch_centile_final(bytea) CASCADE;
psql:sketches.sql:122: NOTICE:  function madlib.__cmsketch_centile_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_centile_final(bytea)
RETURNS int8
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.cmsketch_centile(int8, int8);
psql:sketches.sql:128: NOTICE:  aggregate madlib.cmsketch_centile(int8,int8) does not exist, skipping
CREATE AGGREGATE madlib.cmsketch_centile(int8, int8)
(
    sfunc = madlib.__cmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__cmsketch_centile_final,
		
    initcond = ''
);
DROP FUNCTION IF EXISTS madlib.__cmsketch_median_final(bytea) CASCADE;
psql:sketches.sql:138: NOTICE:  function madlib.__cmsketch_median_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_median_final(bytea)
RETURNS int8
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.cmsketch_median(int8);
psql:sketches.sql:144: NOTICE:  aggregate madlib.cmsketch_median(int8) does not exist, skipping
CREATE AGGREGATE madlib.cmsketch_median(int8)
(
    sfunc = madlib.__cmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__cmsketch_median_final,
		
    initcond = ''
);
DROP FUNCTION IF EXISTS madlib.cmsketch_width_histogram(bytea, int8, int8, int4) CASCADE;
psql:sketches.sql:154: NOTICE:  function madlib.cmsketch_width_histogram(bytea,int8,int8,int4) does not exist, skipping
CREATE FUNCTION madlib.cmsketch_width_histogram(bytea, int8, int8, int4)
RETURNS int8[]
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__cmsketch_dhist_final(bytea) CASCADE;
psql:sketches.sql:160: NOTICE:  function madlib.__cmsketch_dhist_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__cmsketch_dhist_final(bytea)
RETURNS int8[]
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.cmsketch_depth_histogram(int8, int8);
psql:sketches.sql:166: NOTICE:  aggregate madlib.cmsketch_depth_histogram(int8,int8) does not exist, skipping
CREATE AGGREGATE madlib.cmsketch_depth_histogram(int8, int8)
(
    sfunc = madlib.__cmsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__cmsketch_dhist_final,
		
    initcond = ''
);
-- MFV Sketch functions
DROP FUNCTION IF EXISTS madlib.__mfvsketch_trans(bytea, anyelement, int4) CASCADE;
psql:sketches.sql:178: NOTICE:  function madlib.__mfvsketch_trans(bytea,anyelement,int4) does not exist, skipping
CREATE FUNCTION madlib.__mfvsketch_trans(bytea, anyelement, int4)
RETURNS bytea
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP FUNCTION IF EXISTS madlib.__mfvsketch_final(bytea) CASCADE;
psql:sketches.sql:184: NOTICE:  function madlib.__mfvsketch_final(bytea) does not exist, skipping
CREATE FUNCTION madlib.__mfvsketch_final(bytea)
RETURNS text[][]
AS '$libdir/madlib/sketches'
LANGUAGE C STRICT;
DROP AGGREGATE IF EXISTS madlib.mfvsketch_top_histogram(anyelement, int4);
psql:sketches.sql:190: NOTICE:  aggregate madlib.mfvsketch_top_histogram(anyelement,int4) does not exist, skipping
CREATE AGGREGATE madlib.mfvsketch_top_histogram(anyelement, int4)
(
    sfunc = madlib.__mfvsketch_trans,
    stype = bytea, 
    finalfunc = madlib.__mfvsketch_final,
    initcond = ''
);
